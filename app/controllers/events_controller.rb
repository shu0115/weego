# coding: utf-8
class EventsController < ApplicationController

  #-------#
  # index #
  #-------#
  def index
    @events = Event.where( user_id: session[:user_id] ).all
  end

  #-----#
  # new #
  #-----#
  def new
    @event = Event.new
    
    @submit = "create"
  end

  #--------#
  # create #
  #--------#
  def create
    @event = Event.new( params[:event] )
    @event.user_id = session[:user_id]

    if @event.save
      redirect_to( { action: "invite", id: @event.id } )
    else
      render action: "new"
    end
  end
  
  #--------#
  # invite #
  #--------#
  def invite
    @event = Event.where( id: params[:id] ).first
    
    session[:user_id]
    print "[ session[:user_id] ] : " ; p session[:user_id] ;
    print "[ current_user ] : " ; p current_user ;
    
    # Twitter接続設定
    Twitter.configure do |config|
      config.consumer_key       = ENV['TWITTER_KEY']
      config.consumer_secret    = ENV['TWITTER_SECRET']
      config.oauth_token        = current_user.token
      config.oauth_token_secret = current_user.secret
    end
    
    follower_ids = [ 39064374, 562897181, 82378253, 490066043, 5435582, 303241189, 554164667, 11690042, 95613132, 7165272, 384376620, 221764653, 522706175, 5979662, 8120612, 527549685, 62568541, 149440151, 134447571, 49299522, 78050474, 20446861, 95186070, 4035551, 18716117, 138356043, 65359384, 17616038, 515102707, 160083852, 6164512,  ]
#    follower_ids = [ 39064374, 562897181, 82378253, 490066043, 5435582, 303241189, 554164667, 11690042, 95613132, 7165272, 384376620, 221764653, 522706175, 5979662, 8120612, 527549685, 62568541, 149440151, 134447571, 49299522, 78050474, 20446861, 95186070, 4035551, 18716117, 138356043, 65359384, 17616038, 515102707, 160083852, 6164512, 85283794, 5926942, 544865208, 15164153, 15930236, 89843846, 158924539, 214269140, 57648966, 108620919, 17069614, 187089268, 90462417, 306318527, 313030734, 90846260, 49038449, 119991418, 237786222, 33192970, 36003095, 215862345, 3899451, 358589460, 366456679, 129251302, 16497395, 195673910, 91316358, 252053128, 115550504, 62272242, 515195205, 4363521, 509625181, 55480368, 53016974, 175241542, 109800574, 52378616, 91831780, 493051554, 194886249, 136100051, 17698712, 21752974, 94558001, 128834038, 90558020, 153838559, 5713212, 22469134, 481705006, 18569149, 103537498, 437944685, 3900321, 335810873, 357393971, 32315802, 440662114, 4816191, 132784677, 9599682, 446712979, 203804889, 248889409, 142262003, 64425202, 50929091, 147911179, 115026777, 3831641, 104105431, 3628001, 43048144, 429145332, 39528027, 16144803, 75823959, 35255365, 98850227, 15647680, 217824011, 147104715, 29194745, 55490649, 159866679, 49011501, 91316583, 14495552, 85062715, 83026442, 3301651, 3478421, 9310282, 8551582, 60833595, 6592592, 19592374, 294032177, 12714142, 28558617, 77986165, 190544786, 234275010, 39471011, 107094892, 396385245, 349430702, 99694022, 16401502, 2388101, 300782193, 5652122, 109268360, 10690432, 15711050, 44502620, 149537069, 121014703, 14178906, 154872171, 5390442, 343054766, 3705551, 115575609, 340302170, 75752563, 139806811, 60032150, 18893665, 70861174, 245256102, 128543697, 3536531, 70137703, 105672527, 12394712, 138666557, 17303760, 287606751, 14600869, 117209642, 16639388, 9420872, 88181306, 6459812, 14976270, 14908092, 60887251, 72824499, 18074077, 82329331, 48199517, 233056847, 12727622, 292159687, 307156086, 145596544, 293849442, 292233238, 129192888, 130417262, 280816543, 224181045, 296601920, 71835188, 219516091, 11210722, 106366681, 109224961, 97609809, 210715415, 266335975, 101230866, 90445910, 63411921, 128475509, 270810570, 9670542, 115968615, 147676256, 122973543, 265421106, 109193774, 24710181, 59444558, 11155642, 261528646, 261157029, 77984477, 157726804, 186094503, 233509660, 58189853, 61216979, 116852010, 193143901, 253940069, 4292391, 108021074, 74974236, 59406876, 220283706, 133679385, 74745520, 117027954, 99112900, 220916425, 160524095, 122016417, 235868701, 235050002, 19350960, 236157061, 107650661, 106669804, 226169787, 17339445, 230092091, 229882950, 230046709, 78544313, 46604762, 9704272, 69201603, 109207389, 65546023, 21635763, 158272489, 170504016, 179908702, 94014278, 99377525, 58320582, 96563439, 17480580, 121933678, 165605769, 211475549, 73322870, 63667176, 64445430, 14730791, 205493348, 174500602, 149311564, 149141784, 198745992, 88383637, 120282084, 166227135, 8425462, 85750971, 9747262, 14258215, 168665784, 14769808, 17066841, 95910427, 103915249, 190136483, 198772061, 19540705, 156675659, 81734474, 65679701, 191423951, 156004083, 187210435, 121646312, 119846900, 169505858, 90078908, 192333158, 191479882, 107924963, 143023847, 186568747, 139801869, 116376326, 108585900, 161899257, 90873217, 15296357, 109125167, 90615141, 79633111, 95029767, 11982622, 117280359, 120783100, 169550632, 85833580, 6385882, 153332477, 155528483, 1060701, 157245276, 63715041, 134746177, 22519496, 82117394, 14321173, 141250925, 130772935, 72007369, 156230278, 130835732, 160571424, 110967935, 159933310, 159835854, 18076766, 157335429, 135129356, 157402986, 15318974, 29334593, 128097189, 121869137, 154915036, 10582922, 130416171, 111041901, 152392785, 110093647, 86648927, 63181166, 4667511, 130144026, 90037944, 144437220, 23436007, 71557712, 32326007, 94748928, 115676981, 16360912, 75534620, 16110723, 65514755, 16269275, 114632648, 43505559, 47687001, 79751357, 45574094, 83191233, 60097636, 63197146, 56359837, 99477716, 116727046, 114023273, 15892919, 29595995, 43707084, 65936172, 107275118, 6419882, 46691800, 97311965, 55303039, 49956664, 106392179, 21182870, 71832462, 31076855, 33495456, 84463919, 92570772, 90799781, 114451383, 119036624, 63540260, 34562587, 134022529, 130778113, 47269198, 120412698, 44087406, 38305265, 61268771, 131748665, 96453266, 103792825, 142193421, 72479768, 122528901, 15612621, 107452714, 83585409, 98386881, 114480470, 37807528, 137675812, 137950945, 120310178, 3481641, 56652203, 80239546, 105695311, 11904062, 3871961, 56027161, 134738822, 85150346, 68564174, 74165105, 123435394, 120090651, 72866691, 133400682, 115532920, 58857802, 113642189, 131572997, 116230267, 130799520, 69290715, 126352985, 97366853, 96096768, 119685554, 99099930, 114209303, 97244324, 128018810, 126908215, 98839662, 128500086, 52779873, 89154583, 121762224, 115681799, 19222246, 124371288, 113828356, 38435912, 81363456, 123907272, 116683979, 89403443, 68037948, 60795695, 66553503, 90144357, 113837245, 113827034, 113817597, 113831613, 107893060, 108925778, 123482344, 83075543, 120319826, 72696034, 96763451, 6034802, 51661357, 7054852, 122917089, 117107069, 122306449, 112652532, 111216364, 111543107, 72454898, 120499994, 31396577, 102303440, 121648686, 13703692, 70119374, 42594957, 104850567, 122098353, 5978762, 122540052, 55550881, 113829465, 105438375, 121732929, 57870730, 9671202, 65287178, 104179921, 91007068, 98640411, 95864942, 93560510, 119902547, 121748135, 113964470, 112759760, 15711325, 104738942, 113833817, 120993184, 98583228, 74460504, 116151013, 46542963, 100860297, 42375065, 59834596, 106660032, 63620280, 120035933, 70913035, 48618606, 17681513, 103859582, 111287421, 108036041, 90684119, 119664499, 105428463, 104741524, 84503328, 120937172, 98034237, 58722873, 118672336, 112676979, 113993775, 73385916, 103209058, 107669213, 88288736, 48264099, 118300722, 72189363, 116728073, 114653322, 120705871, 47247386, 110366618, 115613506, 85829133, 97151009, 97353125, 108145666, 88658853, 4943161, 113636860, 82087312, 3619961, 95897665, 14342948, 103831722, 109487883, 107092437, 104490560, 106378957, 70915768, 101043122, 100985901, 59081970, 83172709, 15724910, 71489369, 81282028, 60815216, 45272743, 3201061, 72525983, 70139474, 68904376, 38765266, 20966247, 58176633, 46990156, 40843876, 47581923, 16468453, 6634732, 9216732, 31347477, 22662746, 29634069, 22889432, 12978192, 14887521, 14581677, 15492278, 16095916, 17673610, 6795922, 5458492, 14509255, 5367682, 9304152, 7105642, 9101362, 4304451, 7987652, 6359412, 5431762, 14909695, 5457342, 14295017, 3492251, 13089332, 14842278, 12359362, 15264110, 6337522, 13717532, 2140491, 14526481, 15945178, 14362761, 15810268, 5679912, 16700627, 16250262, 14150463, 10546252, 3220271, 6464452, 813286], "previous_cursor_str"=>"0", "next_cursor"=>0}, @collection=[39064374, 562897181, 82378253, 490066043, 5435582, 303241189, 554164667, 11690042, 95613132, 7165272, 384376620, 221764653, 522706175, 5979662, 8120612, 527549685, 62568541, 149440151, 134447571, 49299522, 78050474, 20446861, 95186070, 4035551, 18716117, 138356043, 65359384, 17616038, 515102707, 160083852, 6164512, 85283794, 5926942, 544865208, 15164153, 15930236, 89843846, 158924539, 214269140, 57648966, 108620919, 17069614, 187089268, 90462417, 306318527, 313030734, 90846260, 49038449, 119991418, 237786222, 33192970, 36003095, 215862345, 3899451, 358589460, 366456679, 129251302, 16497395, 195673910, 91316358, 252053128, 115550504, 62272242, 515195205, 4363521, 509625181, 55480368, 53016974, 175241542, 109800574, 52378616, 91831780, 493051554, 194886249, 136100051, 17698712, 21752974, 94558001, 128834038, 90558020, 153838559, 5713212, 22469134, 481705006, 18569149, 103537498, 437944685, 3900321, 335810873, 357393971, 32315802, 440662114, 4816191, 132784677, 9599682, 446712979, 203804889, 248889409, 142262003, 64425202, 50929091, 147911179, 115026777, 3831641, 104105431, 3628001, 43048144, 429145332, 39528027, 16144803, 75823959, 35255365, 98850227, 15647680, 217824011, 147104715, 29194745, 55490649, 159866679, 49011501, 91316583, 14495552, 85062715, 83026442, 3301651, 3478421, 9310282, 8551582, 60833595, 6592592, 19592374, 294032177, 12714142, 28558617, 77986165, 190544786, 234275010, 39471011, 107094892, 396385245, 349430702, 99694022, 16401502, 2388101, 300782193, 5652122, 109268360, 10690432, 15711050, 44502620, 149537069, 121014703, 14178906, 154872171, 5390442, 343054766, 3705551, 115575609, 340302170, 75752563, 139806811, 60032150, 18893665, 70861174, 245256102, 128543697, 3536531, 70137703, 105672527, 12394712, 138666557, 17303760, 287606751, 14600869, 117209642, 16639388, 9420872, 88181306, 6459812, 14976270, 14908092, 60887251, 72824499, 18074077, 82329331, 48199517, 233056847, 12727622, 292159687, 307156086, 145596544, 293849442, 292233238, 129192888, 130417262, 280816543, 224181045, 296601920, 71835188, 219516091, 11210722, 106366681, 109224961, 97609809, 210715415, 266335975, 101230866, 90445910, 63411921, 128475509, 270810570, 9670542, 115968615, 147676256, 122973543, 265421106, 109193774, 24710181, 59444558, 11155642, 261528646, 261157029, 77984477, 157726804, 186094503, 233509660, 58189853, 61216979, 116852010, 193143901, 253940069, 4292391, 108021074, 74974236, 59406876, 220283706, 133679385, 74745520, 117027954, 99112900, 220916425, 160524095, 122016417, 235868701, 235050002, 19350960, 236157061, 107650661, 106669804, 226169787, 17339445, 230092091, 229882950, 230046709, 78544313, 46604762, 9704272, 69201603, 109207389, 65546023, 21635763, 158272489, 170504016, 179908702, 94014278, 99377525, 58320582, 96563439, 17480580, 121933678, 165605769, 211475549, 73322870, 63667176, 64445430, 14730791, 205493348, 174500602, 149311564, 149141784, 198745992, 88383637, 120282084, 166227135, 8425462, 85750971, 9747262, 14258215, 168665784, 14769808, 17066841, 95910427, 103915249, 190136483, 198772061, 19540705, 156675659, 81734474, 65679701, 191423951, 156004083, 187210435, 121646312, 119846900, 169505858, 90078908, 192333158, 191479882, 107924963, 143023847, 186568747, 139801869, 116376326, 108585900, 161899257, 90873217, 15296357, 109125167, 90615141, 79633111, 95029767, 11982622, 117280359, 120783100, 169550632, 85833580, 6385882, 153332477, 155528483, 1060701, 157245276, 63715041, 134746177, 22519496, 82117394, 14321173, 141250925, 130772935, 72007369, 156230278, 130835732, 160571424, 110967935, 159933310, 159835854, 18076766, 157335429, 135129356, 157402986, 15318974, 29334593, 128097189, 121869137, 154915036, 10582922, 130416171, 111041901, 152392785, 110093647, 86648927, 63181166, 4667511, 130144026, 90037944, 144437220, 23436007, 71557712, 32326007, 94748928, 115676981, 16360912, 75534620, 16110723, 65514755, 16269275, 114632648, 43505559, 47687001, 79751357, 45574094, 83191233, 60097636, 63197146, 56359837, 99477716, 116727046, 114023273, 15892919, 29595995, 43707084, 65936172, 107275118, 6419882, 46691800, 97311965, 55303039, 49956664, 106392179, 21182870, 71832462, 31076855, 33495456, 84463919, 92570772, 90799781, 114451383, 119036624, 63540260, 34562587, 134022529, 130778113, 47269198, 120412698, 44087406, 38305265, 61268771, 131748665, 96453266, 103792825, 142193421, 72479768, 122528901, 15612621, 107452714, 83585409, 98386881, 114480470, 37807528, 137675812, 137950945, 120310178, 3481641, 56652203, 80239546, 105695311, 11904062, 3871961, 56027161, 134738822, 85150346, 68564174, 74165105, 123435394, 120090651, 72866691, 133400682, 115532920, 58857802, 113642189, 131572997, 116230267, 130799520, 69290715, 126352985, 97366853, 96096768, 119685554, 99099930, 114209303, 97244324, 128018810, 126908215, 98839662, 128500086, 52779873, 89154583, 121762224, 115681799, 19222246, 124371288, 113828356, 38435912, 81363456, 123907272, 116683979, 89403443, 68037948, 60795695, 66553503, 90144357, 113837245, 113827034, 113817597, 113831613, 107893060, 108925778, 123482344, 83075543, 120319826, 72696034, 96763451, 6034802, 51661357, 7054852, 122917089, 117107069, 122306449, 112652532, 111216364, 111543107, 72454898, 120499994, 31396577, 102303440, 121648686, 13703692, 70119374, 42594957, 104850567, 122098353, 5978762, 122540052, 55550881, 113829465, 105438375, 121732929, 57870730, 9671202, 65287178, 104179921, 91007068, 98640411, 95864942, 93560510, 119902547, 121748135, 113964470, 112759760, 15711325, 104738942, 113833817, 120993184, 98583228, 74460504, 116151013, 46542963, 100860297, 42375065, 59834596, 106660032, 63620280, 120035933, 70913035, 48618606, 17681513, 103859582, 111287421, 108036041, 90684119, 119664499, 105428463, 104741524, 84503328, 120937172, 98034237, 58722873, 118672336, 112676979, 113993775, 73385916, 103209058, 107669213, 88288736, 48264099, 118300722, 72189363, 116728073, 114653322, 120705871, 47247386, 110366618, 115613506, 85829133, 97151009, 97353125, 108145666, 88658853, 4943161, 113636860, 82087312, 3619961, 95897665, 14342948, 103831722, 109487883, 107092437, 104490560, 106378957, 70915768, 101043122, 100985901, 59081970, 83172709, 15724910, 71489369, 81282028, 60815216, 45272743, 3201061, 72525983, 70139474, 68904376, 38765266, 20966247, 58176633, 46990156, 40843876, 47581923, 16468453, 6634732, 9216732, 31347477, 22662746, 29634069, 22889432, 12978192, 14887521, 14581677, 15492278, 16095916, 17673610, 6795922, 5458492, 14509255, 5367682, 9304152, 7105642, 9101362, 4304451, 7987652, 6359412, 5431762, 14909695, 5457342, 14295017, 3492251, 13089332, 14842278, 12359362, 15264110, 6337522, 13717532, 2140491, 14526481, 15945178, 14362761, 15810268, 5679912, 16700627, 16250262, 14150463, 10546252, 3220271, 6464452, 813286 ]
    friend_ids = [691353, 160491085, 19107159, 221764653, 456718318, 49299522, 4035551, 18716117, 65359384, 101823594, 133207698, 6729772, 5926942, 5161091, 85283794, 15930236, 4002671, 17616038, 214269140, 105472870, 187089268, 149505338, 36003095, 215862345, 366456679, 16497395, 91316358, 3596631, 15656336, 214831986, 252053128, 62272242, 115550504, 4363521, 326534671, 55480368, 53016974, 52378616, 109800574, 91831780, 17698712, 3748631, 19347908, 90558020, 153838559, 114355985, 210710651, 23426364, 18569149, 68914747, 20446861, 103537498, 3116191, 3900321, 9873522, 4816191, 7524442, 9599682, 440662114, 425832674, 32315802, 202525729, 22469134, 357393971, 204637161, 248889409, 115026777, 110096078, 3628001, 75823959, 49011501, 58712404, 3960621, 234275921, 14495552, 85062715, 6656012, 40506782, 9310282, 60833595, 6592592, 402838129, 19592374, 294032177]
#    friend_ids = [691353, 160491085, 19107159, 221764653, 456718318, 49299522, 4035551, 18716117, 65359384, 101823594, 133207698, 6729772, 5926942, 5161091, 85283794, 15930236, 4002671, 17616038, 214269140, 105472870, 187089268, 149505338, 36003095, 215862345, 366456679, 16497395, 91316358, 3596631, 15656336, 214831986, 252053128, 62272242, 115550504, 4363521, 326534671, 55480368, 53016974, 52378616, 109800574, 91831780, 17698712, 3748631, 19347908, 90558020, 153838559, 114355985, 210710651, 23426364, 18569149, 68914747, 20446861, 103537498, 3116191, 3900321, 9873522, 4816191, 7524442, 9599682, 440662114, 425832674, 32315802, 202525729, 22469134, 357393971, 204637161, 248889409, 115026777, 110096078, 3628001, 75823959, 49011501, 58712404, 3960621, 234275921, 14495552, 85062715, 6656012, 40506782, 9310282, 60833595, 6592592, 402838129, 19592374, 294032177, 12714142, 6162202, 3831641, 117746068, 320691091, 107094892, 80348735, 396385245, 4587741, 203804889, 236309195, 175002211, 50594375, 14372143, 381476374, 146072832, 217118946, 96126652, 89097038, 93552057, 214963197, 221376043, 166077971, 160111053, 279955888, 311581881, 349430702, 222746686, 16401502, 13585812, 364208865, 39471011, 5652122, 249573985, 14490475, 209576618, 186422486, 3305611, 6170402, 49238231, 46074144, 14812429, 10690432, 15711050, 347204339, 44502620, 76905775, 149537069, 159843314, 14178906, 111262408, 4831361, 255770847, 105074520, 10296592, 91316583, 5390442, 288638192, 314335053, 3705551, 340302170, 75752563, 139806811, 201508780, 5767492, 310195041, 87994299, 7533722, 60032150, 18893665, 152167482, 245256102, 148357397, 106595422, 70861174, 128543697, 3536531, 70137703, 129251302, 220509929, 101876272, 196096841, 12394712, 324762006, 10257182, 297254593, 17303760, 287606751, 14600869, 4579921, 9420872, 127911160, 6459812, 14908092, 4053041, 18074077, 82329331, 61652947, 10576802, 229917707, 72824499, 161901500, 12727622, 99845543, 286574472, 313682511, 14210706, 3969281, 233056847, 14295017, 292233238, 92261983, 168497930, 167316304, 85109818, 292159687, 175340096, 138986001, 66149536, 142424634, 177148413, 115982980, 232624716, 251079472, 275296148, 139035290, 245670900, 1622901, 290278021, 151909853, 299367472, 29082801, 143785922, 48318596, 235547108, 9223822, 292299424, 82134463, 39027002, 59119891, 89702799, 296601920, 71835188, 2604941, 21465230, 52671531, 181543874, 60108759, 297245130, 7787712, 11210722, 3301651, 117209642, 4174531, 129192888, 104388107, 53329750, 230143306, 109224961, 95595912, 83774787, 14579639, 135160233, 227156383, 117752733, 207872598, 3857121, 241326613, 130446710, 44940926, 172077124, 166998003, 87769890, 171739663, 233165009, 249954208, 278042855, 21635763, 145295021, 224181045, 90445910, 13334762, 19760185, 63411921, 154872171, 128475509, 126351300, 114392766, 270341564, 265675034, 265814534, 115968615, 147676256, 137272821, 93311525, 50791157, 267658787, 266493890, 128578966, 13006812, 122973543, 109193774, 79633111, 90941597, 142664754, 24710181, 4104111, 143431932, 176759629, 248599224, 258401688, 30366941, 5649672, 58166411, 80230164, 40200717, 145234303, 7220202, 77984477, 116852010, 61216979, 4292391, 4049711, 15573498, 3954811, 11155642, 2799501, 16877746, 91985145, 253188843, 72569649, 59406876, 186297537, 98865204, 220283706, 191885991, 45754828, 246088101, 186094503, 40493869, 2149061, 94701166, 247918432, 59381921, 102278397, 129502332, 108906582, 150537628, 71764687, 128824814, 114070602, 245677083, 220916425, 2806411, 74745520, 117027954, 104507727, 95158230, 14561327, 104738942, 220905215, 160524095, 14510470, 122016417, 79653056, 109453968, 234275010, 157726804, 136318293, 19350960, 85554299, 106669804, 20104013, 226169787, 230092091, 114203832, 45592671, 78016990, 167164816, 147163321, 17339445, 132557865, 13089332, 58634325, 129355980, 9670542, 9704272, 11195332, 205662697, 35998037, 8551582, 69201603, 109207389, 19593023, 88228269, 145220821, 116197195, 155098571, 155790898, 158272489, 203808534, 137621198, 170504016, 210839316, 179908702, 94014278, 194137487, 82606854, 65546023, 76060193, 99377525, 58320582, 55354513, 4067101, 17480580, 212505792, 193660855, 12978192, 165065384, 26500541, 133578531, 142262003, 95395755, 115686977, 125546634, 124075037, 44353677, 116708040, 14730791, 116585717, 149141784, 88383637, 120282084, 40381496, 178566596, 8425462, 166227135, 168665784, 15245189, 14769808, 15105204, 14258215, 14418170, 17066841, 14734225, 16095860, 38765266, 15085500, 78895105, 63667176, 73025168, 117706520, 106325143, 121933678, 95251522, 103915249, 84352845, 85750971, 95910427, 64659588, 190136483, 94304192, 19540705, 193143901, 156675659, 81734474, 143023847, 100369753, 174511656, 171849356, 191423951, 119846900, 114451383, 90078908, 93781788, 148961902, 16981588, 169505858, 70045461, 101031400, 155285684, 110966549, 139801869, 89546228, 161899257, 77281753, 107420140, 92686016, 109125167, 152963467, 176623250, 59444558, 117280359, 177161038, 120783100, 145629125, 87639243, 73861378, 89060170, 98386881, 153332477, 168611679, 168962743, 157245276, 169428831, 104622940, 71890736, 5420322, 14842278, 84625899, 57928905, 61623425, 10075982, 160571424, 120310178, 46542963, 130835732, 72866377, 128097189, 152392785, 152425145, 78547642, 110093647, 130144026, 4667511, 108585900, 71557712, 103452070, 68954056, 96793703, 113278138, 18370476, 45574094, 60097636, 55777504, 49956664, 63197146, 43505559, 21182870, 16110723, 43707084, 33495456, 29595995, 65514755, 71577670, 79751357, 83191233, 88762002, 55303039, 34227269, 95186070, 32326007, 70109028, 99477716, 63016862, 116727046, 31076855, 141250925, 46691800, 88633646, 83070666, 15892919, 6419882, 54845630, 71832462, 63181166, 75534620, 10582922, 12482952, 90799781, 5435582, 5979722, 88181306, 50738137, 27403462, 84463919, 77986165, 43024602, 130778113, 44941919, 63540260, 47269198, 14321173, 86886590, 16360912, 58794150, 90190310, 61268771, 63715041, 86956905, 96453266, 113017487, 103792825, 10998552, 120412698, 15612621, 131748665, 83585409, 78533500, 37807528, 50993077, 78580978, 72893466, 65739320, 92317563, 119325107, 80239546, 105695311, 56027161, 5854932, 90615141, 134465477, 47679066, 56652203, 68564174, 115627312, 33290455, 96355490, 76983476, 90353766, 90433409, 49740380, 69290715, 91720095, 72479768, 22519496, 97366853, 92291791, 62410803, 15493622, 60105788, 39049518, 83843074, 113828356, 68037948, 124415804, 63769336, 78069042, 107893060, 14603166, 43115714, 80751645, 44082559, 48935525, 14223601, 50929395, 85169255, 67588511, 63626697, 121776330, 123128775, 121869137, 69261229, 96707669, 18371743, 100138429, 82261515, 110139193, 5523632, 96684891, 94050482, 6487582, 72756520, 67315143, 64418903, 101933682, 111253533, 114994734, 106660032, 81658029, 60821539, 85891683, 17681513, 17220934, 1825081, 31070671, 90521746, 84503328, 43696594, 113520472, 114703350, 44791521, 114400792, 50771546, 111287421, 115613506, 95464182, 73121158, 73883832, 108159219, 3619961, 82087312, 87027640, 64947203, 99008565, 110660104, 112334115, 99253822, 100985901, 97244324, 80985167, 89631948, 61792188, 83172709, 711493, 15724910, 30010475, 14887521, 4435381, 79689970, 7565522, 12392332, 53948091, 46990156, 20245682, 9101362, 13717532, 15945178, 6634732, 5408132, 15810268, 4304451, 7105642, 5367682, 7173532, 1874271, 14150463, 15413268, 14175746, 10345632, 9747262, 14694518, 10546252, 3314811, 813286, 3201061, 4143991], "previous_cursor_str"=>"0", "next_cursor"=>0}, @collection=[691353, 160491085, 19107159, 221764653, 456718318, 49299522, 4035551, 18716117, 65359384, 101823594, 133207698, 6729772, 5926942, 5161091, 85283794, 15930236, 4002671, 17616038, 214269140, 105472870, 187089268, 149505338, 36003095, 215862345, 366456679, 16497395, 91316358, 3596631, 15656336, 214831986, 252053128, 62272242, 115550504, 4363521, 326534671, 55480368, 53016974, 52378616, 109800574, 91831780, 17698712, 3748631, 19347908, 90558020, 153838559, 114355985, 210710651, 23426364, 18569149, 68914747, 20446861, 103537498, 3116191, 3900321, 9873522, 4816191, 7524442, 9599682, 440662114, 425832674, 32315802, 202525729, 22469134, 357393971, 204637161, 248889409, 115026777, 110096078, 3628001, 75823959, 49011501, 58712404, 3960621, 234275921, 14495552, 85062715, 6656012, 40506782, 9310282, 60833595, 6592592, 402838129, 19592374, 294032177, 12714142, 6162202, 3831641, 117746068, 320691091, 107094892, 80348735, 396385245, 4587741, 203804889, 236309195, 175002211, 50594375, 14372143, 381476374, 146072832, 217118946, 96126652, 89097038, 93552057, 214963197, 221376043, 166077971, 160111053, 279955888, 311581881, 349430702, 222746686, 16401502, 13585812, 364208865, 39471011, 5652122, 249573985, 14490475, 209576618, 186422486, 3305611, 6170402, 49238231, 46074144, 14812429, 10690432, 15711050, 347204339, 44502620, 76905775, 149537069, 159843314, 14178906, 111262408, 4831361, 255770847, 105074520, 10296592, 91316583, 5390442, 288638192, 314335053, 3705551, 340302170, 75752563, 139806811, 201508780, 5767492, 310195041, 87994299, 7533722, 60032150, 18893665, 152167482, 245256102, 148357397, 106595422, 70861174, 128543697, 3536531, 70137703, 129251302, 220509929, 101876272, 196096841, 12394712, 324762006, 10257182, 297254593, 17303760, 287606751, 14600869, 4579921, 9420872, 127911160, 6459812, 14908092, 4053041, 18074077, 82329331, 61652947, 10576802, 229917707, 72824499, 161901500, 12727622, 99845543, 286574472, 313682511, 14210706, 3969281, 233056847, 14295017, 292233238, 92261983, 168497930, 167316304, 85109818, 292159687, 175340096, 138986001, 66149536, 142424634, 177148413, 115982980, 232624716, 251079472, 275296148, 139035290, 245670900, 1622901, 290278021, 151909853, 299367472, 29082801, 143785922, 48318596, 235547108, 9223822, 292299424, 82134463, 39027002, 59119891, 89702799, 296601920, 71835188, 2604941, 21465230, 52671531, 181543874, 60108759, 297245130, 7787712, 11210722, 3301651, 117209642, 4174531, 129192888, 104388107, 53329750, 230143306, 109224961, 95595912, 83774787, 14579639, 135160233, 227156383, 117752733, 207872598, 3857121, 241326613, 130446710, 44940926, 172077124, 166998003, 87769890, 171739663, 233165009, 249954208, 278042855, 21635763, 145295021, 224181045, 90445910, 13334762, 19760185, 63411921, 154872171, 128475509, 126351300, 114392766, 270341564, 265675034, 265814534, 115968615, 147676256, 137272821, 93311525, 50791157, 267658787, 266493890, 128578966, 13006812, 122973543, 109193774, 79633111, 90941597, 142664754, 24710181, 4104111, 143431932, 176759629, 248599224, 258401688, 30366941, 5649672, 58166411, 80230164, 40200717, 145234303, 7220202, 77984477, 116852010, 61216979, 4292391, 4049711, 15573498, 3954811, 11155642, 2799501, 16877746, 91985145, 253188843, 72569649, 59406876, 186297537, 98865204, 220283706, 191885991, 45754828, 246088101, 186094503, 40493869, 2149061, 94701166, 247918432, 59381921, 102278397, 129502332, 108906582, 150537628, 71764687, 128824814, 114070602, 245677083, 220916425, 2806411, 74745520, 117027954, 104507727, 95158230, 14561327, 104738942, 220905215, 160524095, 14510470, 122016417, 79653056, 109453968, 234275010, 157726804, 136318293, 19350960, 85554299, 106669804, 20104013, 226169787, 230092091, 114203832, 45592671, 78016990, 167164816, 147163321, 17339445, 132557865, 13089332, 58634325, 129355980, 9670542, 9704272, 11195332, 205662697, 35998037, 8551582, 69201603, 109207389, 19593023, 88228269, 145220821, 116197195, 155098571, 155790898, 158272489, 203808534, 137621198, 170504016, 210839316, 179908702, 94014278, 194137487, 82606854, 65546023, 76060193, 99377525, 58320582, 55354513, 4067101, 17480580, 212505792, 193660855, 12978192, 165065384, 26500541, 133578531, 142262003, 95395755, 115686977, 125546634, 124075037, 44353677, 116708040, 14730791, 116585717, 149141784, 88383637, 120282084, 40381496, 178566596, 8425462, 166227135, 168665784, 15245189, 14769808, 15105204, 14258215, 14418170, 17066841, 14734225, 16095860, 38765266, 15085500, 78895105, 63667176, 73025168, 117706520, 106325143, 121933678, 95251522, 103915249, 84352845, 85750971, 95910427, 64659588, 190136483, 94304192, 19540705, 193143901, 156675659, 81734474, 143023847, 100369753, 174511656, 171849356, 191423951, 119846900, 114451383, 90078908, 93781788, 148961902, 16981588, 169505858, 70045461, 101031400, 155285684, 110966549, 139801869, 89546228, 161899257, 77281753, 107420140, 92686016, 109125167, 152963467, 176623250, 59444558, 117280359, 177161038, 120783100, 145629125, 87639243, 73861378, 89060170, 98386881, 153332477, 168611679, 168962743, 157245276, 169428831, 104622940, 71890736, 5420322, 14842278, 84625899, 57928905, 61623425, 10075982, 160571424, 120310178, 46542963, 130835732, 72866377, 128097189, 152392785, 152425145, 78547642, 110093647, 130144026, 4667511, 108585900, 71557712, 103452070, 68954056, 96793703, 113278138, 18370476, 45574094, 60097636, 55777504, 49956664, 63197146, 43505559, 21182870, 16110723, 43707084, 33495456, 29595995, 65514755, 71577670, 79751357, 83191233, 88762002, 55303039, 34227269, 95186070, 32326007, 70109028, 99477716, 63016862, 116727046, 31076855, 141250925, 46691800, 88633646, 83070666, 15892919, 6419882, 54845630, 71832462, 63181166, 75534620, 10582922, 12482952, 90799781, 5435582, 5979722, 88181306, 50738137, 27403462, 84463919, 77986165, 43024602, 130778113, 44941919, 63540260, 47269198, 14321173, 86886590, 16360912, 58794150, 90190310, 61268771, 63715041, 86956905, 96453266, 113017487, 103792825, 10998552, 120412698, 15612621, 131748665, 83585409, 78533500, 37807528, 50993077, 78580978, 72893466, 65739320, 92317563, 119325107, 80239546, 105695311, 56027161, 5854932, 90615141, 134465477, 47679066, 56652203, 68564174, 115627312, 33290455, 96355490, 76983476, 90353766, 90433409, 49740380, 69290715, 91720095, 72479768, 22519496, 97366853, 92291791, 62410803, 15493622, 60105788, 39049518, 83843074, 113828356, 68037948, 124415804, 63769336, 78069042, 107893060, 14603166, 43115714, 80751645, 44082559, 48935525, 14223601, 50929395, 85169255, 67588511, 63626697, 121776330, 123128775, 121869137, 69261229, 96707669, 18371743, 100138429, 82261515, 110139193, 5523632, 96684891, 94050482, 6487582, 72756520, 67315143, 64418903, 101933682, 111253533, 114994734, 106660032, 81658029, 60821539, 85891683, 17681513, 17220934, 1825081, 31070671, 90521746, 84503328, 43696594, 113520472, 114703350, 44791521, 114400792, 50771546, 111287421, 115613506, 95464182, 73121158, 73883832, 108159219, 3619961, 82087312, 87027640, 64947203, 99008565, 110660104, 112334115, 99253822, 100985901, 97244324, 80985167, 89631948, 61792188, 83172709, 711493, 15724910, 30010475, 14887521, 4435381, 79689970, 7565522, 12392332, 53948091, 46990156, 20245682, 9101362, 13717532, 15945178, 6634732, 5408132, 15810268, 4304451, 7105642, 5367682, 7173532, 1874271, 14150463, 15413268, 14175746, 10345632, 9747262, 14694518, 10546252, 3314811, 813286, 3201061, 4143991]

    
#    @friend_ids = [1, 2, 3]
    @friend_ids = ["テスト1", "テスト2", "テスト3"]
  end

  #----------#
  # complete #
  #----------#
  def complete
    add_list = params[:add].presence || Hash.new{ |hash, key| hash[key] = Hash.new }
    
    text = "https://weego.heroku.com/events/show/#{params[:event_id]}"
    
    add_list[:ids].each_pair{ |key, value|
      text += CGI.escape( " @#{value}" )
    }
    
    text += " 行く？"
    
    redirect_to "https://twitter.com/intent/tweet?text=#{text}"
  end
  
  #------#
  # show #
  #------#
  def show
    @event = Event.where( id: params[:id], user_id: session[:user_id] ).first
    
    @entries = Entry.where( event_id: @event.id ).includes( :user ).all
  end
  
  
  
  

  #------#
  # edit #
  #------#
  def edit
    @event = Event.where( id: params[:id], user_id: session[:user_id] ).first
    
    @submit = "update"
  end

  #--------#
  # update #
  #--------#
  def update
    @event = Event.where( id: params[:id], user_id: session[:user_id] ).first

    if @event.update_attributes( params[:event] )
      redirect_to( { action: "show", id: params[:id] }, notice: "Event was successfully updated." )
    else
      render action: "edit", id: params[:id]
    end
  end

  #---------#
  # destroy #
  #---------#
  def destroy
    @event = Event.where( id: params[:id], user_id: session[:user_id] ).first
    @event.destroy

    redirect_to action: "index"
  end

end
